{% extends 'MunicipalesBundle:theme:layout.html.twig' %}

{% block title %}{{ 'town.step2.html_title'|trans }}{% endblock %}

{% from 'MunicipalesBundle:macros:steps.html.twig' import steps_town_widget %}
{% form_theme form 'MunicipalesBundle:theme:forms.html.twig' %}

{% block checkbox_widget %}
{% spaceless %}
<input type="checkbox" class="mine" style="width:25px" {{ block('widget_attributes') }}{% if value is defined %} value="{{ value }}"{% endif %}{% if checked %} checked="checked"{% endif %} />
{% endspaceless %}
{% endblock checkbox_widget %}

{% block appjsinline %}
    <script>

    check_countables = function(countable, event)
    {
    	// If first option is checked, then invalidate the others
		if($("#town_step2 ." + countable + "[type='checkbox']").first().prop('checked'))
		{
			$.each($("#town_step2 ." + countable + "[type='checkbox']:checked"), function(key, item) 
			{
				item.checked = false
			});
			
			$("#town_step2 ." + countable + "[type='checkbox']").first().prop('checked', true);
		}
		else
		{
			// If first is not checked count the max items checked
		    if($("#town_step2 ." + countable + "[type='checkbox']:checked").length > 3)
		    {
		    	alert('Solo pueden seleccionarse hasta maximo 3 opciones');
	    		// $( "span" ).text( "Not valid!" ).show().fadeOut( 1000 );
	    		event.preventDefault();
		    }
		    else
		    {
		    	return;
		    }
		}
    }
    
    $(document).ready(function() 
    {
		$(document).on('submit','#town_step2', function(event)
	    {
			check_countables('countable_language', event);
			check_countables('countable_job_experience', event);
			check_countables('countable_town_activities', event);
			check_countables('countable_govern_priorities', event);
			check_countables('countable_public_values', event);
	    });

		// Academic level filter
		$('#vote_step_filter_academic_level_option_1').on('change', function(event)
	    {
		    if($(this)[0].checked)
			{
		    	$('#vote_step_filter_academic_level').parent().css('display', 'block');
			}
		});

		$('#vote_step_filter_academic_level_option_0').on('change', function(event)
		{
			if($(this)[0].checked)
			{
				$('#vote_step_filter_academic_level').parent().css('display', 'none');
			}
		});

		// Language filter
		$('#vote_step_filter_languages_option_1').on('change', function(event)
	    {
			if($(this)[0].checked)
			{
				$('#vote_step_filter_languages_0').parent().parent().parent().parent().css('display', 'block');
			}
		});

		$('#vote_step_filter_languages_option_0').on('change', function(event)
		{
			if($(this)[0].checked)
			{
				$('#vote_step_filter_languages_0').parent().parent().parent().parent().css('display', 'none');
			}
		});

		// Job experience filter
		$('#vote_step_filter_job_experience_option_1').on('change', function(event)
	    {
			if($(this)[0].checked)
			{
				$('#vote_step_filter_job_experience_0').parent().parent().parent().parent().css('display', 'block');
			}
		});

		$('#vote_step_filter_job_experience_option_0').on('change', function(event)
		{
			if($(this)[0].checked)
			{
				$('#vote_step_filter_job_experience_0').parent().parent().parent().parent().css('display', 'none');
			}
		});
		
		// Town Activities filter
		$('#vote_step_filter_town_activities_option_1').on('change', function(event)
	    {
			if($(this)[0].checked)
			{
				$('#vote_step_filter_town_activities_0').parent().parent().parent().parent().css('display', 'block');
			}
		});

		$('#vote_step_filter_town_activities_option_0').on('change', function(event)
		{
			if($(this)[0].checked)
			{
				$('#vote_step_filter_town_activities_0').parent().parent().parent().parent().css('display', 'none');
			}
		});		

		// Govern Priorities filter
		$('#vote_step_filter_govern_priorities_option_1').on('change', function(event)
	    {
			if($(this)[0].checked)
			{
				$('#vote_step_filter_govern_priorities_0').parent().parent().parent().parent().css('display', 'block');
			}
		});

		$('#vote_step_filter_govern_priorities_option_0').on('change', function(event)
		{
			if($(this)[0].checked)
			{
				$('#vote_step_filter_govern_priorities_0').parent().parent().parent().parent().css('display', 'none');
			}
		});	

		// Public Values filter
		$('#vote_step_filter_public_values_option_1').on('change', function(event)
	    {
			if($(this)[0].checked)
			{
				$('#vote_step_filter_public_values_0').parent().parent().parent().parent().css('display', 'block');
				$('#vote_step_filter_public_values_0').parent().parent().parent().parent().parent().css('display', 'block');
			}
		});

		$('#vote_step_filter_public_values_option_0').on('change', function(event)
		{
			if($(this)[0].checked)
			{
				$('#vote_step_filter_public_values_0').parent().parent().parent().parent().css('display', 'none');
				$('#vote_step_filter_public_values_0').parent().parent().parent().parent().parent().css('display', 'none');
			}
		});	
    });
    
	</script>
	<style>
	#vote_step_filter_academic_level_option{display:inline;margin-left:15px}
	#vote_step_filter_languages_option{display:inline;margin-left:15px}
	#vote_step_filter_job_experience_option{display:inline;margin-left:15px}
	#vote_step_filter_town_activities_option{display:inline;margin-left:15px}
	#vote_step_filter_govern_priorities_option{display:inline;margin-left:15px}
	#vote_step_filter_public_values_option{display:inline;margin-left:15px}
	</style>
{% endblock %}

{% block content %}
<section class="section-2">
      <div class="container marketing">

        <div class="headline">
          <h2>{{ 'home.step_h2'|trans }} 2</h2>
        </div><h3 class="featurette-headin"> <i>{{ 'town.step2.h1_title'|trans }}</i>
        </h3>
        
        <!-- START THE FEATURETTES -->

        <hr class="featurette-divider2">
        <!--    division -->
        
        {{ form_start(form, { 'attr': {'class': 'form_settings', 'id': 'town_step2'}}) }}
        
        <div class="row featurette2">
          <div class="widget-box">
            

            <div class="widget-body">
              <div class="widget-main">
              
              	
              	
                <div id="fuelux-wizard-container">
                  {{ steps_town_widget(2, address) }}
                  
				  <hr>

                  <div class="step-content pos-rel">
                  
				  {% if not form.vars.valid and form.vars.errors|length > 0 %}
                  <div class="alert alert-danger">
                          <button data-dismiss="alert" class="close" type="button">
                            <i class="mine-icon fa fa-times"></i>
                          </button>
                          {{ form_errors(form) }}
                  </div>
                  {% endif %}
                          
                    <div data-step="1" class="step-pane active row">
                      <h2 class="lighter block greenl col-xs-10 col-sm-offset-1">{{ 'town.step2.filter_title'|trans }}</h2>
                      
                      <div class="col-sm-offset-1 col-md-10 well">
							{{ 'town.step2.filter_p1'|trans }}
                      </div>
                      
                      <div class="row">
                      
                      	<div class="col-sm-offset-1 col-md-10">
							<div class="control-group" style="display:inline-block;">
								{{ 'town.step2.academic_level'|trans }}
								{{ form_widget(form.academic_level_option, {'separator':none}) }}
								{{ form_errors(form.academic_level_option) }}
							</div>	
							
							<p class="lead2" style="display:none">
								{{ form_widget(form.academic_level) }}
								{{ form_errors(form.academic_level) }}
							</p>
						
							<div class="control-group" style="display:inline-block;">
								{{ 'town.step2.languages'|trans }}
								{{ form_widget(form.languages_option, {'separator':none}) }}
								{{ form_errors(form.languages_option) }}
							</div>	
						
							<p class="lead2" style="display:none">
								<table class="table" style="display:none">
								{% for child in form.languages %}
									<tr>
								        <td>{{ form_widget(child, {'attr' : {'class' : 'countable_language mine'}}) }}</td>
								        <td style="padding:5px">{{ form_label(child) }}{{ form_errors(child) }}</td>       
								    </tr>
								{% endfor %}
								</table>
							</p>
							
							
							
							<div class="control-group" style="display:inline-block;">
								{{ 'town.step3.job_experience_title'|trans }}
								{{ form_widget(form.job_experience_option, {'separator':none}) }}
								{{ form_errors(form.job_experience_option) }}
							</div>
						
							<p class="lead2" style="display:none">
								<table class="table" style="display:none">
								{% for child in form.job_experience %}
									<tr>
								        <td>{{ form_widget(child, {'attr' : {'class' : 'countable_job_experience mine'}}) }}</td> 
								        <td style="padding:5px">{{ form_label(child) }}{{ form_errors(child) }}</td>       
								    </tr>
								{% endfor %}
								</table>
							</p>
						
						
							<div class="control-group" style="display:inline-block;">
								{{ 'town.step4.town_activities_title'|trans }}
								{{ form_widget(form.town_activities_option, {'separator':none}) }}
								{{ form_errors(form.town_activities_option) }}
							</div>	
						
							<p class="lead2" style="display:none">
								<table class="table" style="display:none">
								{% for child in form.town_activities %}
									<tr>
								        <td>{{ form_widget(child, {'attr' : {'class' : 'countable_town_activities mine'}}) }}</td> 
								        <td style="padding:5px">{{ form_label(child) }}{{ form_errors(child) }}</td>       
								    </tr>
								{% endfor %}
								</table>
							</p>
							
							
							
							<div class="control-group" style="display:inline-block;">
								{{ 'town.step5.govern_priorities_title'|trans }}
								{{ form_widget(form.govern_priorities_option, {'separator':none}) }}
								{{ form_errors(form.govern_priorities_option) }}
							</div>
	
							<p class="lead2" style="display:none">
								<table class="table" style="display:none">
								{% for child in form.govern_priorities %}
									<tr>
								        <td>{{ form_widget(child, {'attr' : {'class' : 'countable_govern_priorities mine'}}) }}</td> 
								        <td style="padding:5px">{{ form_label(child) }}{{ form_errors(child) }}</td>       
								    </tr>
								{% endfor %}
								</table>
							</p>
							
							<div class="control-group" style="display:inline-block;">
								{{ 'town.step5.public_values_title'|trans }}
								{{ form_widget(form.public_values_option, {'separator':none}) }}
								{{ form_errors(form.public_values_option) }}
							</div>
						
							<div class="lead2" style="display:none">
								<table class="table" style="display:none">
								{% for child in form.public_values %}
									<tr>
								        <td>{{ form_widget(child, {'attr' : {'class' : 'countable_public_values mine'}}) }}</td> 
								        <td style="padding:5px">{{ form_label(child) }}{{ form_errors(child) }}</td>       
								    </tr>
								{% endfor %}
								</table>
							</div>
						
						
							
						</div>
			          
			          </div>

                      
                    </div>


                    
                  </div>
                </div>

                <hr>
                <div class="wizard-actions">

				  <button class="btn btn-prev" onclick="location.href='{{ path('town_candidacy_step_verify', {'address' : address }) }}'; return false;">
                    <i class="mine-icon fa fa-arrow-left"></i>
                    {{ 'town.step_verify.previous'|trans }}
                  </button>
                  
                  {{ form_widget(form.continue, { 'label': 'town.step2.continue'|trans|raw, 'attr' : { 'class' : 'submit btn btn-success btn-next'} }) }}

                </div>
              </div>
              
              
              <!-- /.widget-main --> </div>
            <!-- /.widget-body --> </div>
        </div>

        {{ form_rest(form) }}
			
		{{ form_end(form) }}
			  
        <!--    division -->

        <!-- /END THE FEATURETTES --> </div>
        
</section>
{% endblock %}